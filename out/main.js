"use strict";var Ur=Object.create;var fe=Object.defineProperty;var Vr=Object.getOwnPropertyDescriptor;var Wr=Object.getOwnPropertyNames;var kr=Object.getPrototypeOf,Hr=Object.prototype.hasOwnProperty;var u=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),$r=(r,e)=>{for(var t in e)fe(r,t,{get:e[t],enumerable:!0})},It=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Wr(e))!Hr.call(r,n)&&n!==t&&fe(r,n,{get:()=>e[n],enumerable:!(i=Vr(e,n))||i.enumerable});return r};var Ge=(r,e,t)=>(t=r!=null?Ur(kr(r)):{},It(e||!r||!r.__esModule?fe(t,"default",{value:r,enumerable:!0}):t,r)),Gr=r=>It(fe({},"__esModule",{value:!0}),r);var qt=u(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.ByteLengthParser=void 0;var zr=require("stream"),ze=class extends zr.Transform{length;position;buffer;constructor(e){if(super(e),typeof e.length!="number")throw new TypeError('"length" is not a number');if(e.length<1)throw new TypeError('"length" is not greater than 0');this.length=e.length,this.position=0,this.buffer=Buffer.alloc(this.length)}_transform(e,t,i){let n=0;for(;n<e.length;)this.buffer[this.position]=e[n],n++,this.position++,this.position===this.length&&(this.push(this.buffer),this.buffer=Buffer.alloc(this.length),this.position=0);i()}_flush(e){this.push(this.buffer.slice(0,this.position)),this.buffer=Buffer.alloc(this.length),e()}};de.ByteLengthParser=ze});var At=u(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.CCTalkParser=void 0;var Kr=require("stream"),Ke=class extends Kr.Transform{array;cursor;lastByteFetchTime;maxDelayBetweenBytesMs;constructor(e=50){super(),this.array=[],this.cursor=0,this.lastByteFetchTime=0,this.maxDelayBetweenBytesMs=e}_transform(e,t,i){if(this.maxDelayBetweenBytesMs>0){let n=Date.now();n-this.lastByteFetchTime>this.maxDelayBetweenBytesMs&&(this.array=[],this.cursor=0),this.lastByteFetchTime=n}for(this.cursor+=e.length,Array.from(e).map(n=>this.array.push(n));this.cursor>1&&this.cursor>=this.array[1]+5;){let n=this.array[1]+5,s=Buffer.from(this.array.slice(0,n));this.array=this.array.slice(s.length,this.array.length),this.cursor-=n,this.push(s)}i()}};he.CCTalkParser=Ke});var Ye=u(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.DelimiterParser=void 0;var Jr=require("stream"),Je=class extends Jr.Transform{includeDelimiter;delimiter;buffer;constructor({delimiter:e,includeDelimiter:t=!1,...i}){if(super(i),e===void 0)throw new TypeError('"delimiter" is not a bufferable object');if(e.length===0)throw new TypeError('"delimiter" has a 0 or undefined length');this.includeDelimiter=t,this.delimiter=Buffer.from(e),this.buffer=Buffer.alloc(0)}_transform(e,t,i){let n=Buffer.concat([this.buffer,e]),s;for(;(s=n.indexOf(this.delimiter))!==-1;)this.push(n.slice(0,s+(this.includeDelimiter?this.delimiter.length:0))),n=n.slice(s+this.delimiter.length);this.buffer=n,i()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}};pe.DelimiterParser=Je});var Lt=u(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.InterByteTimeoutParser=void 0;var Yr=require("stream"),Qe=class extends Yr.Transform{maxBufferSize;currentPacket;interval;intervalID;constructor({maxBufferSize:e=65536,interval:t,...i}){if(super(i),!t)throw new TypeError('"interval" is required');if(typeof t!="number"||Number.isNaN(t))throw new TypeError('"interval" is not a number');if(t<1)throw new TypeError('"interval" is not greater than 0');if(typeof e!="number"||Number.isNaN(e))throw new TypeError('"maxBufferSize" is not a number');if(e<1)throw new TypeError('"maxBufferSize" is not greater than 0');this.maxBufferSize=e,this.currentPacket=[],this.interval=t}_transform(e,t,i){this.intervalID&&clearTimeout(this.intervalID);for(let n=0;n<e.length;n++)this.currentPacket.push(e[n]),this.currentPacket.length>=this.maxBufferSize&&this.emitPacket();this.intervalID=setTimeout(this.emitPacket.bind(this),this.interval),i()}emitPacket(){this.intervalID&&clearTimeout(this.intervalID),this.currentPacket.length>0&&this.push(Buffer.from(this.currentPacket)),this.currentPacket=[]}_flush(e){this.emitPacket(),e()}};we.InterByteTimeoutParser=Qe});var Ut=u(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.PacketLengthParser=void 0;var Qr=require("stream"),Xe=class extends Qr.Transform{buffer;start;opts;constructor(e={}){super(e);let{delimiter:t=170,packetOverhead:i=2,lengthBytes:n=1,lengthOffset:s=1,maxLen:a=255}=e;this.opts={delimiter:t,packetOverhead:i,lengthBytes:n,lengthOffset:s,maxLen:a},this.buffer=Buffer.alloc(0),this.start=!1}_transform(e,t,i){for(let n=0;n<e.length;n++){let s=e[n];if(s===this.opts.delimiter&&(this.start=!0),this.start===!0&&(this.buffer=Buffer.concat([this.buffer,Buffer.from([s])]),this.buffer.length>=this.opts.lengthOffset+this.opts.lengthBytes)){let a=this.buffer.readUIntLE(this.opts.lengthOffset,this.opts.lengthBytes);(this.buffer.length==a+this.opts.packetOverhead||a>this.opts.maxLen)&&(this.push(this.buffer),this.buffer=Buffer.alloc(0),this.start=!1)}}i()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}};ye.PacketLengthParser=Xe});var et=u(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.ReadlineParser=void 0;var Xr=Ye(),Ze=class extends Xr.DelimiterParser{constructor(e){let t={delimiter:Buffer.from(`
`,"utf8"),encoding:"utf8",...e};typeof t.delimiter=="string"&&(t.delimiter=Buffer.from(t.delimiter,t.encoding)),super(t)}};ge.ReadlineParser=Ze});var Vt=u(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.ReadyParser=void 0;var Zr=require("stream"),tt=class extends Zr.Transform{delimiter;readOffset;ready;constructor({delimiter:e,...t}){if(e===void 0)throw new TypeError('"delimiter" is not a bufferable object');if(e.length===0)throw new TypeError('"delimiter" has a 0 or undefined length');super(t),this.delimiter=Buffer.from(e),this.readOffset=0,this.ready=!1}_transform(e,t,i){if(this.ready)return this.push(e),i();let n=this.delimiter,s=0;for(;this.readOffset<n.length&&s<e.length;)n[this.readOffset]===e[s]?this.readOffset++:this.readOffset=0,s++;if(this.readOffset===n.length){this.ready=!0,this.emit("ready");let a=e.slice(s);a.length>0&&this.push(a)}i()}};me.ReadyParser=tt});var Wt=u(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.RegexParser=void 0;var ei=require("stream"),rt=class extends ei.Transform{regex;data;constructor({regex:e,...t}){let i={encoding:"utf8",...t};if(e===void 0)throw new TypeError('"options.regex" must be a regular expression pattern or object');e instanceof RegExp||(e=new RegExp(e.toString())),super(i),this.regex=e,this.data=""}_transform(e,t,i){let s=(this.data+e).split(this.regex);this.data=s.pop()||"",s.forEach(a=>{this.push(a)}),i()}_flush(e){this.push(this.data),this.data="",e()}};be.RegexParser=rt});var kt=u(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.SlipDecoder=void 0;var ti=require("stream"),it=class extends ti.Transform{opts;buffer;escape;start;constructor(e={}){super(e);let{START:t,ESC:i=219,END:n=192,ESC_START:s,ESC_END:a=220,ESC_ESC:f=221}=e;this.opts={START:t,ESC:i,END:n,ESC_START:s,ESC_END:a,ESC_ESC:f},this.buffer=Buffer.alloc(0),this.escape=!1,this.start=!1}_transform(e,t,i){for(let n=0;n<e.length;n++){let s=e[n];if(s===this.opts.START){this.start=!0;continue}else this.opts.START==null&&(this.start=!0);if(this.escape)s===this.opts.ESC_START&&this.opts.START?s=this.opts.START:s===this.opts.ESC_ESC?s=this.opts.ESC:s===this.opts.ESC_END?s=this.opts.END:(this.escape=!1,this.push(this.buffer),this.buffer=Buffer.alloc(0));else{if(s===this.opts.ESC){this.escape=!0;continue}if(s===this.opts.END){this.push(this.buffer),this.buffer=Buffer.alloc(0),this.escape=!1,this.start=!1;continue}}this.escape=!1,this.start&&(this.buffer=Buffer.concat([this.buffer,Buffer.from([s])]))}i()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}};_e.SlipDecoder=it});var Ht=u(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.SlipEncoder=void 0;var ri=require("stream"),nt=class extends ri.Transform{opts;constructor(e={}){super(e);let{START:t,ESC:i=219,END:n=192,ESC_START:s,ESC_END:a=220,ESC_ESC:f=221,bluetoothQuirk:d=!1}=e;this.opts={START:t,ESC:i,END:n,ESC_START:s,ESC_END:a,ESC_ESC:f,bluetoothQuirk:d}}_transform(e,t,i){let n=e.length;if(this.opts.bluetoothQuirk&&n===0)return i();let s=Buffer.alloc(n*2+2),a=0;this.opts.bluetoothQuirk==!0&&(s[a++]=this.opts.END),this.opts.START!==void 0&&(s[a++]=this.opts.START);for(let f=0;f<n;f++){let d=e[f];d===this.opts.START&&this.opts.ESC_START?(s[a++]=this.opts.ESC,d=this.opts.ESC_START):d===this.opts.END?(s[a++]=this.opts.ESC,d=this.opts.ESC_END):d===this.opts.ESC&&(s[a++]=this.opts.ESC,d=this.opts.ESC_ESC),s[a++]=d}s[a++]=this.opts.END,i(null,s.slice(0,a))}};Ee.SlipEncoder=nt});var Gt=u(L=>{"use strict";var ii=L&&L.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),$t=L&&L.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ii(e,r,t)};Object.defineProperty(L,"__esModule",{value:!0});$t(kt(),L);$t(Ht(),L)});var zt=u(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.convertHeaderBufferToObj=Y.HEADER_LENGTH=void 0;Y.HEADER_LENGTH=6;var ni=r=>{let e=Number(r).toString(2);for(;e.length<8;)e=`0${e}`;return e},si=r=>{let e=Array.from(r.slice(0,Y.HEADER_LENGTH)).reduce((o,l)=>`${o}${ni(l)}`,""),i=e.slice(0,3)==="000"?1:"UNKNOWN_VERSION",n=Number(e[3]),s=Number(e[4]),a=parseInt(e.slice(5,16),2),f=parseInt(e.slice(16,18),2),d=parseInt(e.slice(18,32),2),E=parseInt(e.slice(-16),2)+1;return{versionNumber:i,identification:{apid:a,secondaryHeader:s,type:n},sequenceControl:{packetName:d,sequenceFlags:f},dataLength:E}};Y.convertHeaderBufferToObj=si});var Kt=u(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.SpacePacketParser=void 0;var oi=require("stream"),Oe=zt(),st=class extends oi.Transform{timeCodeFieldLength;ancillaryDataFieldLength;dataBuffer;headerBuffer;dataLength;expectingHeader;dataSlice;header;constructor(e={}){super({...e,objectMode:!0}),this.timeCodeFieldLength=e.timeCodeFieldLength||0,this.ancillaryDataFieldLength=e.ancillaryDataFieldLength||0,this.dataSlice=this.timeCodeFieldLength+this.ancillaryDataFieldLength,this.dataBuffer=Buffer.alloc(0),this.headerBuffer=Buffer.alloc(0),this.dataLength=0,this.expectingHeader=!0}pushCompletedPacket(){if(!this.header)throw new Error("Missing header");let e=Buffer.from(this.dataBuffer.slice(0,this.timeCodeFieldLength)),t=Buffer.from(this.dataBuffer.slice(this.timeCodeFieldLength,this.timeCodeFieldLength+this.ancillaryDataFieldLength)),i=Buffer.from(this.dataBuffer.slice(this.dataSlice,this.dataLength)),n={header:{...this.header},data:i.toString()};(e.length>0||t.length>0)&&(n.secondaryHeader={},e.length&&(n.secondaryHeader.timeCode=e.toString()),t.length&&(n.secondaryHeader.ancillaryData=t.toString())),this.push(n);let s=Buffer.from(this.dataBuffer.slice(this.dataLength));s.length>=Oe.HEADER_LENGTH?this.extractHeader(s):(this.headerBuffer=s,this.dataBuffer=Buffer.alloc(0),this.expectingHeader=!0,this.dataLength=0,this.header=void 0)}extractHeader(e){let t=Buffer.concat([this.headerBuffer,e]),i=t.slice(Oe.HEADER_LENGTH);t.length>=Oe.HEADER_LENGTH?(this.header=(0,Oe.convertHeaderBufferToObj)(t),this.dataLength=this.header.dataLength,this.headerBuffer=Buffer.alloc(0),this.expectingHeader=!1):this.headerBuffer=t,i.length>0&&(this.dataBuffer=Buffer.from(i),this.dataBuffer.length>=this.dataLength&&this.pushCompletedPacket())}_transform(e,t,i){this.expectingHeader?this.extractHeader(e):(this.dataBuffer=Buffer.concat([this.dataBuffer,e]),this.dataBuffer.length>=this.dataLength&&this.pushCompletedPacket()),i()}_flush(e){let t=Buffer.concat([this.headerBuffer,this.dataBuffer]),i=Array.from(t);this.push(i),e()}};ve.SpacePacketParser=st});var Yt=u((gs,Jt)=>{var te=1e3,re=te*60,ie=re*60,Q=ie*24,ai=Q*7,ui=Q*365.25;Jt.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return ci(r);if(t==="number"&&isFinite(r))return e.long?fi(r):li(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function ci(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*ui;case"weeks":case"week":case"w":return t*ai;case"days":case"day":case"d":return t*Q;case"hours":case"hour":case"hrs":case"hr":case"h":return t*ie;case"minutes":case"minute":case"mins":case"min":case"m":return t*re;case"seconds":case"second":case"secs":case"sec":case"s":return t*te;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function li(r){var e=Math.abs(r);return e>=Q?Math.round(r/Q)+"d":e>=ie?Math.round(r/ie)+"h":e>=re?Math.round(r/re)+"m":e>=te?Math.round(r/te)+"s":r+"ms"}function fi(r){var e=Math.abs(r);return e>=Q?Ce(r,e,Q,"day"):e>=ie?Ce(r,e,ie,"hour"):e>=re?Ce(r,e,re,"minute"):e>=te?Ce(r,e,te,"second"):r+" ms"}function Ce(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var ot=u((ms,Qt)=>{function di(r){t.debug=t,t.default=t,t.coerce=d,t.disable=s,t.enable=n,t.enabled=a,t.humanize=Yt(),t.destroy=E,Object.keys(r).forEach(o=>{t[o]=r[o]}),t.names=[],t.skips=[],t.formatters={};function e(o){let l=0;for(let w=0;w<o.length;w++)l=(l<<5)-l+o.charCodeAt(w),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(o){let l,w=null,ee,ne;function M(...C){if(!M.enabled)return;let J=M,ce=Number(new Date),qr=ce-(l||ce);J.diff=qr,J.prev=l,J.curr=ce,l=ce,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let le=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,($e,Ar)=>{if($e==="%%")return"%";le++;let jt=t.formatters[Ar];if(typeof jt=="function"){let Lr=C[le];$e=jt.call(J,Lr),C.splice(le,1),le--}return $e}),t.formatArgs.call(J,C),(J.log||t.log).apply(J,C)}return M.namespace=o,M.useColors=t.useColors(),M.color=t.selectColor(o),M.extend=i,M.destroy=t.destroy,Object.defineProperty(M,"enabled",{enumerable:!0,configurable:!1,get:()=>w!==null?w:(ee!==t.namespaces&&(ee=t.namespaces,ne=t.enabled(o)),ne),set:C=>{w=C}}),typeof t.init=="function"&&t.init(M),M}function i(o,l){let w=t(this.namespace+(typeof l>"u"?":":l)+o);return w.log=this.log,w}function n(o){t.save(o),t.namespaces=o,t.names=[],t.skips=[];let l,w=(typeof o=="string"?o:"").split(/[\s,]+/),ee=w.length;for(l=0;l<ee;l++)w[l]&&(o=w[l].replace(/\*/g,".*?"),o[0]==="-"?t.skips.push(new RegExp("^"+o.slice(1)+"$")):t.names.push(new RegExp("^"+o+"$")))}function s(){let o=[...t.names.map(f),...t.skips.map(f).map(l=>"-"+l)].join(",");return t.enable(""),o}function a(o){if(o[o.length-1]==="*")return!0;let l,w;for(l=0,w=t.skips.length;l<w;l++)if(t.skips[l].test(o))return!1;for(l=0,w=t.names.length;l<w;l++)if(t.names[l].test(o))return!0;return!1}function f(o){return o.toString().substring(2,o.toString().length-2).replace(/\.\*\?$/,"*")}function d(o){return o instanceof Error?o.stack||o.message:o}function E(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Qt.exports=di});var Xt=u((v,Be)=>{v.formatArgs=pi;v.save=wi;v.load=yi;v.useColors=hi;v.storage=gi();v.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();v.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function hi(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function pi(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Be.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}v.log=console.debug||console.log||(()=>{});function wi(r){try{r?v.storage.setItem("debug",r):v.storage.removeItem("debug")}catch{}}function yi(){let r;try{r=v.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function gi(){try{return localStorage}catch{}}Be.exports=ot()(v);var{formatters:mi}=Be.exports;mi.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var er=u((bs,Zt)=>{"use strict";Zt.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",i=e.indexOf(t+r),n=e.indexOf("--");return i!==-1&&(n===-1||i<n)}});var ir=u((_s,rr)=>{"use strict";var bi=require("os"),tr=require("tty"),B=er(),{env:g}=process,U;B("no-color")||B("no-colors")||B("color=false")||B("color=never")?U=0:(B("color")||B("colors")||B("color=true")||B("color=always"))&&(U=1);"FORCE_COLOR"in g&&(g.FORCE_COLOR==="true"?U=1:g.FORCE_COLOR==="false"?U=0:U=g.FORCE_COLOR.length===0?1:Math.min(parseInt(g.FORCE_COLOR,10),3));function at(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function ut(r,e){if(U===0)return 0;if(B("color=16m")||B("color=full")||B("color=truecolor"))return 3;if(B("color=256"))return 2;if(r&&!e&&U===void 0)return 0;let t=U||0;if(g.TERM==="dumb")return t;if(process.platform==="win32"){let i=bi.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in g)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(i=>i in g)||g.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in g)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(g.TEAMCITY_VERSION)?1:0;if(g.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in g){let i=parseInt((g.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(g.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(g.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(g.TERM)||"COLORTERM"in g?1:t}function _i(r){let e=ut(r,r&&r.isTTY);return at(e)}rr.exports={supportsColor:_i,stdout:at(ut(!0,tr.isatty(1))),stderr:at(ut(!0,tr.isatty(2)))}});var sr=u((b,Pe)=>{var Ei=require("tty"),Te=require("util");b.init=Ni;b.log=Bi;b.formatArgs=vi;b.save=Ti;b.load=Pi;b.useColors=Oi;b.destroy=Te.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");b.colors=[6,2,3,4,5,1];try{let r=ir();r&&(r.stderr||r).level>=2&&(b.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}b.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,s)=>s.toUpperCase()),i=process.env[e];return/^(yes|on|true|enabled)$/i.test(i)?i=!0:/^(no|off|false|disabled)$/i.test(i)?i=!1:i==="null"?i=null:i=Number(i),r[t]=i,r},{});function Oi(){return"colors"in b.inspectOpts?!!b.inspectOpts.colors:Ei.isatty(process.stderr.fd)}function vi(r){let{namespace:e,useColors:t}=this;if(t){let i=this.color,n="\x1B[3"+(i<8?i:"8;5;"+i),s=`  ${n};1m${e} \x1B[0m`;r[0]=s+r[0].split(`
`).join(`
`+s),r.push(n+"m+"+Pe.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=Ci()+e+" "+r[0]}function Ci(){return b.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Bi(...r){return process.stderr.write(Te.format(...r)+`
`)}function Ti(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function Pi(){return process.env.DEBUG}function Ni(r){r.inspectOpts={};let e=Object.keys(b.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=b.inspectOpts[e[t]]}Pe.exports=ot()(b);var{formatters:nr}=Pe.exports;nr.o=function(r){return this.inspectOpts.colors=this.useColors,Te.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};nr.O=function(r){return this.inspectOpts.colors=this.useColors,Te.inspect(r,this.inspectOpts)}});var F=u((Es,ct)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?ct.exports=Xt():ct.exports=sr()});var ft=u(V=>{"use strict";var Ri=V&&V.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(V,"__esModule",{value:!0});V.SerialPortStream=V.DisconnectedError=void 0;var Di=require("stream"),Si=Ri(F()),c=(0,Si.default)("serialport/stream"),Ne=class extends Error{disconnected;constructor(e){super(e),this.disconnected=!0}};V.DisconnectedError=Ne;var xi={brk:!1,cts:!1,dtr:!0,rts:!0};function or(r){let e=Buffer.allocUnsafe(r);return e.used=0,e}var lt=class extends Di.Duplex{port;_pool;_kMinPoolSpace;opening;closing;settings;constructor(e,t){let i={autoOpen:!0,endOnClose:!1,highWaterMark:65536,...e};if(super({highWaterMark:i.highWaterMark}),!i.binding)throw new TypeError('"Bindings" is invalid pass it as `options.binding`');if(!i.path)throw new TypeError(`"path" is not defined: ${i.path}`);if(typeof i.baudRate!="number")throw new TypeError(`"baudRate" must be a number: ${i.baudRate}`);this.settings=i,this.opening=!1,this.closing=!1,this._pool=or(this.settings.highWaterMark),this._kMinPoolSpace=128,this.settings.autoOpen&&this.open(t)}get path(){return this.settings.path}get baudRate(){return this.settings.baudRate}get isOpen(){return(this.port?.isOpen??!1)&&!this.closing}_error(e,t){t?t.call(this,e):this.emit("error",e)}_asyncError(e,t){process.nextTick(()=>this._error(e,t))}open(e){if(this.isOpen)return this._asyncError(new Error("Port is already open"),e);if(this.opening)return this._asyncError(new Error("Port is opening"),e);let{highWaterMark:t,binding:i,autoOpen:n,endOnClose:s,...a}=this.settings;this.opening=!0,c("opening",`path: ${this.path}`),this.settings.binding.open(a).then(f=>{c("opened",`path: ${this.path}`),this.port=f,this.opening=!1,this.emit("open"),e&&e.call(this,null)},f=>{this.opening=!1,c("Binding #open had an error",f),this._error(f,e)})}update(e,t){if(!this.isOpen||!this.port)return c("update attempted, but port is not open"),this._asyncError(new Error("Port is not open"),t);c("update",`baudRate: ${e.baudRate}`),this.port.update(e).then(()=>{c("binding.update","finished"),this.settings.baudRate=e.baudRate,t&&t.call(this,null)},i=>(c("binding.update","error",i),this._error(i,t)))}write(e,t,i){return Array.isArray(e)&&(e=Buffer.from(e)),typeof t=="function"?super.write(e,t):super.write(e,t,i)}_write(e,t,i){if(!this.isOpen||!this.port){this.once("open",()=>{this._write(e,t,i)});return}c("_write",`${e.length} bytes of data`),this.port.write(e).then(()=>{c("binding.write","write finished"),i(null)},n=>{c("binding.write","error",n),n.canceled||this._disconnected(n),i(n)})}_writev(e,t){c("_writev",`${e.length} chunks of data`);let i=e.map(n=>n.chunk);this._write(Buffer.concat(i),void 0,t)}_read(e){if(!this.isOpen||!this.port){c("_read","queueing _read for after open"),this.once("open",()=>{this._read(e)});return}(!this._pool||this._pool.length-this._pool.used<this._kMinPoolSpace)&&(c("_read","discarding the read buffer pool because it is below kMinPoolSpace"),this._pool=or(this.settings.highWaterMark));let t=this._pool,i=Math.min(t.length-t.used,e),n=t.used;c("_read","reading",{start:n,toRead:i}),this.port.read(t,n,i).then(({bytesRead:s})=>{if(c("binding.read","finished",{bytesRead:s}),s===0){c("binding.read","Zero bytes read closing readable stream"),this.push(null);return}t.used+=s,this.push(t.slice(n,n+s))},s=>{c("binding.read","error",s),s.canceled||this._disconnected(s),this._read(e)})}_disconnected(e){if(!this.isOpen){c("disconnected aborted because already closed",e);return}c("disconnected",e),this.close(void 0,new Ne(e.message))}close(e,t=null){if(!this.isOpen||!this.port)return c("close attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);this.closing=!0,c("#close"),this.port.close().then(()=>{this.closing=!1,c("binding.close","finished"),this.emit("close",t),this.settings.endOnClose&&this.emit("end"),e&&e.call(this,t)},i=>(this.closing=!1,c("binding.close","had an error",i),this._error(i,e)))}set(e,t){if(!this.isOpen||!this.port)return c("set attempted, but port is not open"),this._asyncError(new Error("Port is not open"),t);let i={...xi,...e};c("#set",i),this.port.set(i).then(()=>{c("binding.set","finished"),t&&t.call(this,null)},n=>(c("binding.set","had an error",n),this._error(n,t)))}get(e){if(!this.isOpen||!this.port)return c("get attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);c("#get"),this.port.get().then(t=>{c("binding.get","finished"),e.call(this,null,t)},t=>(c("binding.get","had an error",t),this._error(t,e)))}flush(e){if(!this.isOpen||!this.port)return c("flush attempted, but port is not open"),this._asyncError(new Error("Port is not open"),e);c("#flush"),this.port.flush().then(()=>{c("binding.flush","finished"),e&&e.call(this,null)},t=>(c("binding.flush","had an error",t),this._error(t,e)))}drain(e){if(c("drain"),!this.isOpen||!this.port){c("drain queuing on port open"),this.once("open",()=>{this.drain(e)});return}this.port.drain().then(()=>{c("binding.drain","finished"),e&&e.call(this,null)},t=>(c("binding.drain","had an error",t),this._error(t,e)))}};V.SerialPortStream=lt});var ar=u(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});var Mi=F();function Fi(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var ji=Fi(Mi),y=ji.default("serialport/binding-mock"),Re={},De=0;function q(){return new Promise(r=>process.nextTick(()=>r()))}var se=class extends Error{constructor(e){super(e),this.canceled=!0}},Ii={reset(){Re={},De=0},createPort(r,e={}){De++;let t=Object.assign({echo:!1,record:!1,manufacturer:"The J5 Robotics Company",vendorId:void 0,productId:void 0,maxReadSize:1024},e);Re[r]={data:Buffer.alloc(0),echo:t.echo,record:t.record,readyData:t.readyData,maxReadSize:t.maxReadSize,info:{path:r,manufacturer:t.manufacturer,serialNumber:`${De}`,pnpId:void 0,locationId:void 0,vendorId:t.vendorId,productId:t.productId}},y(De,"created port",JSON.stringify({path:r,opt:e}))},async list(){return y(null,"list"),Object.values(Re).map(r=>r.info)},async open(r){var e;if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError('"options" is not an object');if(!r.path)throw new TypeError('"path" is not a valid port');if(!r.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');let t=Object.assign({dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},r),{path:i}=t;y(null,`open: opening path ${i}`);let n=Re[i];if(await q(),!n)throw new Error(`Port does not exist - please call MockBinding.createPort('${i}') first`);let s=n.info.serialNumber;if(!((e=n.openOpt)===null||e===void 0)&&e.lock)throw y(s,"open: Port is locked cannot open"),new Error("Port is locked cannot open");return y(s,`open: opened path ${i}`),n.openOpt=Object.assign({},t),new Se(n,t)}},Se=class{constructor(e,t){if(this.port=e,this.openOptions=t,this.pendingRead=null,this.isOpen=!0,this.lastWrite=null,this.recording=Buffer.alloc(0),this.writeOperation=null,this.serialNumber=e.info.serialNumber,e.readyData){let i=e.readyData;process.nextTick(()=>{this.isOpen&&(y(this.serialNumber,"emitting ready data"),this.emitData(i))})}}emitData(e){if(!this.isOpen||!this.port)throw new Error("Port must be open to pretend to receive data");let t=Buffer.isBuffer(e)?e:Buffer.from(e);y(this.serialNumber,"emitting data - pending read:",!!this.pendingRead),this.port.data=Buffer.concat([this.port.data,t]),this.pendingRead&&(process.nextTick(this.pendingRead),this.pendingRead=null)}async close(){if(y(this.serialNumber,"close"),!this.isOpen)throw new Error("Port is not open");let e=this.port;if(!e)throw new Error("already closed");e.openOpt=void 0,e.data=Buffer.alloc(0),y(this.serialNumber,"port is closed"),this.serialNumber=void 0,this.isOpen=!1,this.pendingRead&&this.pendingRead(new se("port is closed"))}async read(e,t,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(typeof t!="number"||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if(typeof i!="number"||isNaN(i))throw new TypeError(`"length" is not an integer got "${isNaN(i)?"NaN":typeof i}"`);if(e.length<t+i)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");if(y(this.serialNumber,"read",i,"bytes"),await q(),!this.isOpen||!this.port)throw new se("Read canceled");if(this.port.data.length<=0)return new Promise((f,d)=>{this.pendingRead=E=>{if(E)return d(E);this.read(e,t,i).then(f,d)}});let n=this.port.maxReadSize>i?i:this.port.maxReadSize,a=this.port.data.slice(0,n).copy(e,t);return this.port.data=this.port.data.slice(n),y(this.serialNumber,"read",a,"bytes"),{bytesRead:a,buffer:e}}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(!this.isOpen||!this.port)throw y("write","error port is not open"),new Error("Port is not open");if(y(this.serialNumber,"write",e.length,"bytes"),this.writeOperation)throw new Error("Overlapping writes are not supported and should be queued by the serialport object");return this.writeOperation=(async()=>{if(await q(),!this.isOpen||!this.port)throw new Error("Write canceled");let t=this.lastWrite=Buffer.from(e);this.port.record&&(this.recording=Buffer.concat([this.recording,t])),this.port.echo&&process.nextTick(()=>{this.isOpen&&this.emitData(t)}),this.writeOperation=null,y(this.serialNumber,"writing finished")})(),this.writeOperation}async update(e){if(typeof e!="object")throw TypeError('"options" is not an object');if(typeof e.baudRate!="number")throw new TypeError('"options.baudRate" is not a number');if(y(this.serialNumber,"update"),!this.isOpen||!this.port)throw new Error("Port is not open");await q(),this.port.openOpt&&(this.port.openOpt.baudRate=e.baudRate)}async set(e){if(typeof e!="object")throw new TypeError('"options" is not an object');if(y(this.serialNumber,"set"),!this.isOpen)throw new Error("Port is not open");await q()}async get(){if(y(this.serialNumber,"get"),!this.isOpen)throw new Error("Port is not open");return await q(),{cts:!0,dsr:!1,dcd:!1}}async getBaudRate(){var e;if(y(this.serialNumber,"getBaudRate"),!this.isOpen||!this.port)throw new Error("Port is not open");if(await q(),!(!((e=this.port.openOpt)===null||e===void 0)&&e.baudRate))throw new Error("Internal Error");return{baudRate:this.port.openOpt.baudRate}}async flush(){if(y(this.serialNumber,"flush"),!this.isOpen||!this.port)throw new Error("Port is not open");await q(),this.port.data=Buffer.alloc(0)}async drain(){if(y(this.serialNumber,"drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await q()}};oe.CanceledError=se;oe.MockBinding=Ii;oe.MockPortBinding=Se});var ur=u(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.SerialPortMock=void 0;var qi=ft(),dt=ar(),ht=class extends qi.SerialPortStream{static list=dt.MockBinding.list;static binding=dt.MockBinding;constructor(e,t){let i={binding:dt.MockBinding,...e};super(i,t)}};xe.SerialPortMock=ht});var Cr=u((Bs,vr)=>{var dr=require("fs"),A=require("path"),hr=require("os"),pr=typeof __webpack_require__=="function"?__non_webpack_require__:require,Ai=process.config&&process.config.variables||{},Li=!!process.env.PREBUILDS_ONLY,cr=process.versions.modules,pt=Wi()?"electron":Vi()?"node-webkit":"node",wt=process.env.npm_config_arch||hr.arch(),yt=process.env.npm_config_platform||hr.platform(),wr=process.env.LIBC||(ki(yt)?"musl":"glibc"),gt=process.env.ARM_VERSION||(wt==="arm64"?"8":Ai.arm_version)||"",yr=(process.versions.uv||"").split(".")[0];vr.exports=j;function j(r){return pr(j.resolve(r))}j.resolve=j.path=function(r){r=A.resolve(r||".");try{var e=pr(A.join(r,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[e+"_PREBUILD"]&&(r=process.env[e+"_PREBUILD"])}catch{}if(!Li){var t=lr(A.join(r,"build/Release"),fr);if(t)return t;var i=lr(A.join(r,"build/Debug"),fr);if(i)return i}var n=f(r);if(n)return n;var s=f(A.dirname(process.execPath));if(s)return s;var a=["platform="+yt,"arch="+wt,"runtime="+pt,"abi="+cr,"uv="+yr,gt?"armv="+gt:"","libc="+wr,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+a+`
    loaded from: `+r+`
`);function f(d){var E=mt(A.join(d,"prebuilds")).map(gr),o=E.filter(mr(yt,wt)).sort(br)[0];if(o){var l=A.join(d,"prebuilds",o.name),w=mt(l).map(_r),ee=w.filter(Er(pt,cr)),ne=ee.sort(Or(pt))[0];if(ne)return A.join(l,ne.file)}}};function mt(r){try{return dr.readdirSync(r)}catch{return[]}}function lr(r,e){var t=mt(r).filter(e);return t[0]&&A.join(r,t[0])}function fr(r){return/\.node$/.test(r)}function gr(r){var e=r.split("-");if(e.length===2){var t=e[0],i=e[1].split("+");if(t&&i.length&&i.every(Boolean))return{name:r,platform:t,architectures:i}}}function mr(r,e){return function(t){return t==null||t.platform!==r?!1:t.architectures.includes(e)}}function br(r,e){return r.architectures.length-e.architectures.length}function _r(r){var e=r.split("."),t=e.pop(),i={file:r,specificity:0};if(t==="node"){for(var n=0;n<e.length;n++){var s=e[n];if(s==="node"||s==="electron"||s==="node-webkit")i.runtime=s;else if(s==="napi")i.napi=!0;else if(s.slice(0,3)==="abi")i.abi=s.slice(3);else if(s.slice(0,2)==="uv")i.uv=s.slice(2);else if(s.slice(0,4)==="armv")i.armv=s.slice(4);else if(s==="glibc"||s==="musl")i.libc=s;else continue;i.specificity++}return i}}function Er(r,e){return function(t){return!(t==null||t.runtime!==r&&!Ui(t)||t.abi!==e&&!t.napi||t.uv&&t.uv!==yr||t.armv&&t.armv!==gt||t.libc&&t.libc!==wr)}}function Ui(r){return r.runtime==="node"&&r.napi}function Or(r){return function(e,t){return e.runtime!==t.runtime?e.runtime===r?-1:1:e.abi!==t.abi?e.abi?-1:1:e.specificity!==t.specificity?e.specificity>t.specificity?-1:1:0}}function Vi(){return!!(process.versions&&process.versions.nw)}function Wi(){return process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function ki(r){return r==="linux"&&dr.existsSync("/etc/alpine-release")}j.parseTags=_r;j.matchTags=Er;j.compareTags=Or;j.parseTuple=gr;j.matchTuple=mr;j.compareTuples=br});var _t=u((Ts,bt)=>{typeof process.addon=="function"?bt.exports=process.addon.bind(process):bt.exports=Cr()});var Me=u(h=>{"use strict";var Hi=h&&h.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(h,"__esModule",{value:!0});h.asyncWrite=h.asyncRead=h.asyncUpdate=h.asyncSet=h.asyncOpen=h.asyncList=h.asyncGetBaudRate=h.asyncGet=h.asyncFlush=h.asyncDrain=h.asyncClose=void 0;var $i=Hi(_t()),D=require("util"),Gi=require("path"),p=(0,$i.default)((0,Gi.join)(__dirname,"../"));h.asyncClose=p.close?(0,D.promisify)(p.close):async()=>{throw new Error('"binding.close" Method not implemented')};h.asyncDrain=p.drain?(0,D.promisify)(p.drain):async()=>{throw new Error('"binding.drain" Method not implemented')};h.asyncFlush=p.flush?(0,D.promisify)(p.flush):async()=>{throw new Error('"binding.flush" Method not implemented')};h.asyncGet=p.get?(0,D.promisify)(p.get):async()=>{throw new Error('"binding.get" Method not implemented')};h.asyncGetBaudRate=p.getBaudRate?(0,D.promisify)(p.getBaudRate):async()=>{throw new Error('"binding.getBaudRate" Method not implemented')};h.asyncList=p.list?(0,D.promisify)(p.list):async()=>{throw new Error('"binding.list" Method not implemented')};h.asyncOpen=p.open?(0,D.promisify)(p.open):async()=>{throw new Error('"binding.open" Method not implemented')};h.asyncSet=p.set?(0,D.promisify)(p.set):async()=>{throw new Error('"binding.set" Method not implemented')};h.asyncUpdate=p.update?(0,D.promisify)(p.update):async()=>{throw new Error('"binding.update" Method not implemented')};h.asyncRead=p.read?(0,D.promisify)(p.read):async()=>{throw new Error('"binding.read" Method not implemented')};h.asyncWrite=p.write?(0,D.promisify)(p.write):async()=>{throw new Error('"binding.write" Method not implemented')}});var je=u(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.BindingsError=void 0;var Et=class extends Error{constructor(e,{canceled:t=!1}={}){super(e),this.canceled=t}};Fe.BindingsError=Et});var vt=u(_=>{"use strict";var Br=_&&_.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_,"__esModule",{value:!0});_.Poller=_.EVENTS=void 0;var zi=Br(F()),Ki=require("events"),Ji=require("path"),Yi=Br(_t()),Qi=je(),{Poller:Xi}=(0,Yi.default)((0,Ji.join)(__dirname,"../")),I=(0,zi.default)("serialport/bindings-cpp/poller");_.EVENTS={UV_READABLE:1,UV_WRITABLE:2,UV_DISCONNECT:4};function Zi(r,e){if(r){I("error",r),this.emit("readable",r),this.emit("writable",r),this.emit("disconnect",r);return}e&_.EVENTS.UV_READABLE&&(I('received "readable"'),this.emit("readable",null)),e&_.EVENTS.UV_WRITABLE&&(I('received "writable"'),this.emit("writable",null)),e&_.EVENTS.UV_DISCONNECT&&(I('received "disconnect"'),this.emit("disconnect",null))}var Ot=class extends Ki.EventEmitter{constructor(e,t=Xi){I("Creating poller"),super(),this.poller=new t(e,Zi.bind(this))}once(e,t){switch(e){case"readable":this.poll(_.EVENTS.UV_READABLE);break;case"writable":this.poll(_.EVENTS.UV_WRITABLE);break;case"disconnect":this.poll(_.EVENTS.UV_DISCONNECT);break}return super.once(e,t)}poll(e=0){e&_.EVENTS.UV_READABLE&&I('Polling for "readable"'),e&_.EVENTS.UV_WRITABLE&&I('Polling for "writable"'),e&_.EVENTS.UV_DISCONNECT&&I('Polling for "disconnect"'),this.poller.poll(e)}stop(){I("Stopping poller"),this.poller.stop(),this.emitCanceled()}destroy(){I("Destroying poller"),this.poller.destroy(),this.emitCanceled()}emitCanceled(){let e=new Qi.BindingsError("Canceled",{canceled:!0});this.emit("readable",e),this.emit("writable",e),this.emit("disconnect",e)}};_.Poller=Ot});var Ct=u(W=>{"use strict";var en=W&&W.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(W,"__esModule",{value:!0});W.unixRead=void 0;var tn=require("util"),rn=require("fs"),Tr=je(),nn=en(F()),ae=(0,nn.default)("serialport/bindings-cpp/unixRead"),sn=(0,tn.promisify)(rn.read),on=r=>new Promise((e,t)=>{if(!r.poller)throw new Error("No poller on bindings");r.poller.once("readable",i=>i?t(i):e())}),an=async({binding:r,buffer:e,offset:t,length:i,fsReadAsync:n=sn})=>{if(ae("Starting read"),!r.isOpen||!r.fd)throw new Tr.BindingsError("Port is not open",{canceled:!0});try{let{bytesRead:s}=await n(r.fd,e,t,i,null);return s===0?(0,W.unixRead)({binding:r,buffer:e,offset:t,length:i,fsReadAsync:n}):(ae("Finished read",s,"bytes"),{bytesRead:s,buffer:e})}catch(s){if(ae("read error",s),s.code==="EAGAIN"||s.code==="EWOULDBLOCK"||s.code==="EINTR"){if(!r.isOpen)throw new Tr.BindingsError("Port is not open",{canceled:!0});return ae("waiting for readable because of code:",s.code),await on(r),(0,W.unixRead)({binding:r,buffer:e,offset:t,length:i,fsReadAsync:n})}throw(s.code==="EBADF"||s.code==="ENXIO"||s.code==="UNKNOWN"||s.errno===-1)&&(s.disconnect=!0,ae("disconnecting",s)),s}};W.unixRead=an});var Bt=u(k=>{"use strict";var un=k&&k.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(k,"__esModule",{value:!0});k.unixWrite=void 0;var cn=require("fs"),ln=un(F()),fn=require("util"),X=(0,ln.default)("serialport/bindings-cpp/unixWrite"),dn=(0,fn.promisify)(cn.write),hn=r=>new Promise((e,t)=>{r.poller.once("writable",i=>i?t(i):e())}),pn=async({binding:r,buffer:e,offset:t=0,fsWriteAsync:i=dn})=>{let n=e.length-t;if(X("Starting write",e.length,"bytes offset",t,"bytesToWrite",n),!r.isOpen||!r.fd)throw new Error("Port is not open");try{let{bytesWritten:s}=await i(r.fd,e,t,n);if(X("write returned: wrote",s,"bytes"),s+t<e.length){if(!r.isOpen)throw new Error("Port is not open");return(0,k.unixWrite)({binding:r,buffer:e,offset:s+t,fsWriteAsync:i})}X("Finished writing",s+t,"bytes")}catch(s){if(X("write errored",s),s.code==="EAGAIN"||s.code==="EWOULDBLOCK"||s.code==="EINTR"){if(!r.isOpen)throw new Error("Port is not open");return X("waiting for writable because of code:",s.code),await hn(r),(0,k.unixWrite)({binding:r,buffer:e,offset:t,fsWriteAsync:i})}throw(s.code==="EBADF"||s.code==="ENXIO"||s.code==="UNKNOWN"||s.errno===-1)&&(s.disconnect=!0,X("disconnecting",s)),X("error",s),s}};k.unixWrite=pn});var Tt=u($=>{"use strict";var wn=$&&$.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($,"__esModule",{value:!0});$.DarwinPortBinding=$.DarwinBinding=void 0;var yn=wn(F()),H=Me(),gn=vt(),mn=Ct(),bn=Bt(),T=(0,yn.default)("serialport/bindings-cpp");$.DarwinBinding={list(){return T("list"),(0,H.asyncList)()},async open(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError('"options" is not an object');if(!r.path)throw new TypeError('"path" is not a valid port');if(!r.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');T("open");let e=Object.assign({vmin:1,vtime:0,dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},r),t=await(0,H.asyncOpen)(e.path,e);return new Ie(t,e)}};var Ie=class{constructor(e,t){this.fd=e,this.openOptions=t,this.poller=new gn.Poller(e),this.writeOperation=null}get isOpen(){return this.fd!==null}async close(){if(T("close"),!this.isOpen)throw new Error("Port is not open");let e=this.fd;this.poller.stop(),this.poller.destroy(),this.fd=null,await(0,H.asyncClose)(e)}async read(e,t,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(typeof t!="number"||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if(typeof i!="number"||isNaN(i))throw new TypeError(`"length" is not an integer got "${isNaN(i)?"NaN":typeof i}"`);if(T("read"),e.length<t+i)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");return(0,mn.unixRead)({binding:this,buffer:e,offset:t,length:i})}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(T("write",e.length,"bytes"),!this.isOpen)throw T("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{e.length!==0&&(await(0,bn.unixWrite)({binding:this,buffer:e}),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||typeof e!="object"||Array.isArray(e))throw TypeError('"options" is not an object');if(typeof e.baudRate!="number")throw new TypeError('"options.baudRate" is not a number');if(T("update"),!this.isOpen)throw new Error("Port is not open");await(0,H.asyncUpdate)(this.fd,e)}async set(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError('"options" is not an object');if(T("set",e),!this.isOpen)throw new Error("Port is not open");await(0,H.asyncSet)(this.fd,e)}async get(){if(T("get"),!this.isOpen)throw new Error("Port is not open");return(0,H.asyncGet)(this.fd)}async getBaudRate(){throw T("getBaudRate"),this.isOpen?new Error("getBaudRate is not implemented on darwin"):new Error("Port is not open")}async flush(){if(T("flush"),!this.isOpen)throw new Error("Port is not open");await(0,H.asyncFlush)(this.fd)}async drain(){if(T("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,H.asyncDrain)(this.fd)}};$.DarwinPortBinding=Ie});var Pr=u(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.DelimiterParser=void 0;var _n=require("stream"),Pt=class extends _n.Transform{constructor({delimiter:e,includeDelimiter:t=!1,...i}){if(super(i),e===void 0)throw new TypeError('"delimiter" is not a bufferable object');if(e.length===0)throw new TypeError('"delimiter" has a 0 or undefined length');this.includeDelimiter=t,this.delimiter=Buffer.from(e),this.buffer=Buffer.alloc(0)}_transform(e,t,i){let n=Buffer.concat([this.buffer,e]),s;for(;(s=n.indexOf(this.delimiter))!==-1;)this.push(n.slice(0,s+(this.includeDelimiter?this.delimiter.length:0))),n=n.slice(s+this.delimiter.length);this.buffer=n,i()}_flush(e){this.push(this.buffer),this.buffer=Buffer.alloc(0),e()}};qe.DelimiterParser=Pt});var Nr=u(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.ReadlineParser=void 0;var En=Pr(),Nt=class extends En.DelimiterParser{constructor(e){let t={delimiter:Buffer.from(`
`,"utf8"),encoding:"utf8",...e};typeof t.delimiter=="string"&&(t.delimiter=Buffer.from(t.delimiter,t.encoding)),super(t)}};Ae.ReadlineParser=Nt});var Rr=u(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.linuxList=void 0;var On=require("child_process"),vn=Nr();function Cn(r){return/(tty(S|WCH|ACM|USB|AMA|MFD|O|XRUSB)|rfcomm)/.test(r)&&r}function Bn(r){return{DEVNAME:"path",ID_VENDOR_ENC:"manufacturer",ID_SERIAL_SHORT:"serialNumber",ID_VENDOR_ID:"vendorId",ID_MODEL_ID:"productId",DEVLINKS:"pnpId",ID_USB_VENDOR_ENC:"manufacturer",ID_USB_SERIAL_SHORT:"serialNumber",ID_USB_VENDOR_ID:"vendorId",ID_USB_MODEL_ID:"productId"}[r.toUpperCase()]}function Tn(r){return r.replace(/\\x([a-fA-F0-9]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}function Pn(r,e){if(r==="pnpId"){let t=e.match(/\/by-id\/([^\s]+)/);return t?.[1]||void 0}return r==="manufacturer"?Tn(e):/^0x/.test(e)?e.substr(2):e}function Nn(r=On.spawn){let e=[],t=r("udevadm",["info","-e"]),i=t.stdout.pipe(new vn.ReadlineParser),n=!1,s={path:"",manufacturer:void 0,serialNumber:void 0,pnpId:void 0,locationId:void 0,vendorId:void 0,productId:void 0};return i.on("data",a=>{let f=a.slice(0,1),d=a.slice(3);if(f==="P"){s={path:"",manufacturer:void 0,serialNumber:void 0,pnpId:void 0,locationId:void 0,vendorId:void 0,productId:void 0},n=!1;return}if(!n){if(f==="N"){Cn(d)?e.push(s):n=!0;return}if(f==="E"){let E=d.match(/^(.+)=(.*)/);if(!E)return;let o=Bn(E[1]);if(!o)return;s[o]=Pn(o,E[2])}}}),new Promise((a,f)=>{t.on("close",d=>{d&&f(new Error(`Error listing ports udevadm exited with error code: ${d}`))}),t.on("error",f),i.on("error",f),i.on("finish",()=>a(e))})}Le.linuxList=Nn});var Rt=u(z=>{"use strict";var Rn=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(z,"__esModule",{value:!0});z.LinuxPortBinding=z.LinuxBinding=void 0;var Dn=Rn(F()),Sn=Rr(),xn=vt(),Mn=Ct(),Fn=Bt(),G=Me(),P=(0,Dn.default)("serialport/bindings-cpp");z.LinuxBinding={list(){return P("list"),(0,Sn.linuxList)()},async open(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError('"options" is not an object');if(!r.path)throw new TypeError('"path" is not a valid port');if(!r.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');P("open");let e=Object.assign({vmin:1,vtime:0,dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,xon:!1,xoff:!1,xany:!1,hupcl:!0},r),t=await(0,G.asyncOpen)(e.path,e);return this.fd=t,new Ue(t,e)}};var Ue=class{constructor(e,t){this.fd=e,this.openOptions=t,this.poller=new xn.Poller(e),this.writeOperation=null}get isOpen(){return this.fd!==null}async close(){if(P("close"),!this.isOpen)throw new Error("Port is not open");let e=this.fd;this.poller.stop(),this.poller.destroy(),this.fd=null,await(0,G.asyncClose)(e)}async read(e,t,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(typeof t!="number"||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if(typeof i!="number"||isNaN(i))throw new TypeError(`"length" is not an integer got "${isNaN(i)?"NaN":typeof i}"`);if(P("read"),e.length<t+i)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");return(0,Mn.unixRead)({binding:this,buffer:e,offset:t,length:i})}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(P("write",e.length,"bytes"),!this.isOpen)throw P("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{e.length!==0&&(await(0,Fn.unixWrite)({binding:this,buffer:e}),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||typeof e!="object"||Array.isArray(e))throw TypeError('"options" is not an object');if(typeof e.baudRate!="number")throw new TypeError('"options.baudRate" is not a number');if(P("update"),!this.isOpen)throw new Error("Port is not open");await(0,G.asyncUpdate)(this.fd,e)}async set(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError('"options" is not an object');if(P("set"),!this.isOpen)throw new Error("Port is not open");await(0,G.asyncSet)(this.fd,e)}async get(){if(P("get"),!this.isOpen)throw new Error("Port is not open");return(0,G.asyncGet)(this.fd)}async getBaudRate(){if(P("getBaudRate"),!this.isOpen)throw new Error("Port is not open");return(0,G.asyncGetBaudRate)(this.fd)}async flush(){if(P("flush"),!this.isOpen)throw new Error("Port is not open");await(0,G.asyncFlush)(this.fd)}async drain(){if(P("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,G.asyncDrain)(this.fd)}};z.LinuxPortBinding=Ue});var Dr=u(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.serialNumParser=void 0;var jn=[/USB\\(?:.+)\\(.+)/,/FTDIBUS\\(?:.+)\+(.+?)A?\\.+/],In=r=>{if(!r)return null;for(let e of jn){let t=r.match(e);if(t)return t[1]}return null};Ve.serialNumParser=In});var Dt=u(K=>{"use strict";var qn=K&&K.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(K,"__esModule",{value:!0});K.WindowsPortBinding=K.WindowsBinding=void 0;var An=qn(F()),Ln=St(),x=Me(),Un=Dr(),S=(0,An.default)("serialport/bindings-cpp");K.WindowsBinding={async list(){return(await(0,x.asyncList)()).map(e=>{if(e.pnpId&&!e.serialNumber){let t=(0,Un.serialNumParser)(e.pnpId);if(t)return Object.assign(Object.assign({},e),{serialNumber:t})}return e})},async open(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError('"options" is not an object');if(!r.path)throw new TypeError('"path" is not a valid port');if(!r.baudRate)throw new TypeError('"baudRate" is not a valid baudRate');S("open");let e=Object.assign({dataBits:8,lock:!0,stopBits:1,parity:"none",rtscts:!1,rtsMode:"handshake",xon:!1,xoff:!1,xany:!1,hupcl:!0},r),t=await(0,x.asyncOpen)(e.path,e);return new We(t,e)}};var We=class{constructor(e,t){this.fd=e,this.openOptions=t,this.writeOperation=null}get isOpen(){return this.fd!==null}async close(){if(S("close"),!this.isOpen)throw new Error("Port is not open");let e=this.fd;this.fd=null,await(0,x.asyncClose)(e)}async read(e,t,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(typeof t!="number"||isNaN(t))throw new TypeError(`"offset" is not an integer got "${isNaN(t)?"NaN":typeof t}"`);if(typeof i!="number"||isNaN(i))throw new TypeError(`"length" is not an integer got "${isNaN(i)?"NaN":typeof i}"`);if(S("read"),e.length<t+i)throw new Error("buffer is too small");if(!this.isOpen)throw new Error("Port is not open");try{return{bytesRead:await(0,x.asyncRead)(this.fd,e,t,i),buffer:e}}catch(n){throw this.isOpen?n:new Ln.BindingsError(n.message,{canceled:!0})}}async write(e){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" is not a Buffer');if(S("write",e.length,"bytes"),!this.isOpen)throw S("write","error port is not open"),new Error("Port is not open");return this.writeOperation=(async()=>{e.length!==0&&(await(0,x.asyncWrite)(this.fd,e),this.writeOperation=null)})(),this.writeOperation}async update(e){if(!e||typeof e!="object"||Array.isArray(e))throw TypeError('"options" is not an object');if(typeof e.baudRate!="number")throw new TypeError('"options.baudRate" is not a number');if(S("update"),!this.isOpen)throw new Error("Port is not open");await(0,x.asyncUpdate)(this.fd,e)}async set(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError('"options" is not an object');if(S("set",e),!this.isOpen)throw new Error("Port is not open");await(0,x.asyncSet)(this.fd,e)}async get(){if(S("get"),!this.isOpen)throw new Error("Port is not open");return(0,x.asyncGet)(this.fd)}async getBaudRate(){if(S("getBaudRate"),!this.isOpen)throw new Error("Port is not open");return(0,x.asyncGetBaudRate)(this.fd)}async flush(){if(S("flush"),!this.isOpen)throw new Error("Port is not open");await(0,x.asyncFlush)(this.fd)}async drain(){if(S("drain"),!this.isOpen)throw new Error("Port is not open");await this.writeOperation,await(0,x.asyncDrain)(this.fd)}};K.WindowsPortBinding=We});var Sr=u(()=>{"use strict"});var St=u(O=>{"use strict";var Vn=O&&O.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),ue=O&&O.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vn(e,r,t)},Wn=O&&O.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(O,"__esModule",{value:!0});O.autoDetect=void 0;var kn=Wn(F()),Hn=Tt(),$n=Rt(),Gn=Dt(),xt=(0,kn.default)("serialport/bindings-cpp");ue(Sr(),O);ue(Tt(),O);ue(Rt(),O);ue(Dt(),O);ue(je(),O);function zn(){switch(process.platform){case"win32":return xt("loading WindowsBinding"),Gn.WindowsBinding;case"darwin":return xt("loading DarwinBinding"),Hn.DarwinBinding;default:return xt("loading LinuxBinding"),$n.LinuxBinding}}O.autoDetect=zn});var xr=u(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.SerialPort=void 0;var Kn=ft(),Jn=St(),Mt=(0,Jn.autoDetect)(),Ft=class extends Kn.SerialPortStream{static list=Mt.list;static binding=Mt;constructor(e,t){let i={binding:Mt,...e};super(i,t)}};ke.SerialPort=Ft});var Mr=u(m=>{"use strict";var Yn=m&&m.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),N=m&&m.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Yn(e,r,t)};Object.defineProperty(m,"__esModule",{value:!0});N(qt(),m);N(At(),m);N(Ye(),m);N(Lt(),m);N(Ut(),m);N(et(),m);N(Vt(),m);N(Wt(),m);N(Gt(),m);N(Kt(),m);N(ur(),m);N(xr(),m)});var ts={};$r(ts,{activate:()=>Xn,deactivate:()=>es});module.exports=Gr(ts);var R=Ge(require("vscode")),jr=Ge(require("path")),Ir=Ge(require("fs")),{SerialPort:Qn}=Mr(),{readLine:Hs}=et(),He,Z;function Xn(r){r.subscriptions.push(R.commands.registerCommand("webview.webWorld",()=>{if(He){He.reveal(R.ViewColumn.One);return}let e=R.window.createWebviewPanel("webview","Web View",R.ViewColumn.One,{enableScripts:!0});He=e,Ir.readFile(jr.join(r.extensionPath,"src","index.html"),(t,i)=>{t&&console.log(t);let n=i.toString(),s=n.match(/src\=\"(.*)\"/g),a=n.match(/href\=\"(.*)\"/g);if(s!=null&&a!=null)for(let f of[...s,...a]){let d=f.split('"')[1],E=R.Uri.joinPath(r.extensionUri,"./src/"+d),o=e.webview.asWebviewUri(E),l=f.replace(d,o.toString());console.log(d,E,o),n=n.replace(f,l)}e.webview.html=n}),e.onDidDispose(()=>{Z.on("open",()=>{Fr()})}),e.webview.onDidReceiveMessage(t=>{switch(t.command){case"alert":R.window.showInformationMessage(t.text),console.log(t.text);return;case"serialStart":R.window.showInformationMessage(t.text),console.log("Reached here"),Zn();case"serialStop":R.window.showInformationMessage(t.text),Fr()}},void 0,r.subscriptions)}))}function Zn(){console.log("reached serial function"),Z=new Qn({path:"COM4",baudRate:115200},function(r){console.log("reached inner function"),console.log(r?"error":"Opening serial port")}),console.log("Port Created next steop reading"),Z.on("readable",function(){Z.read()===null?console.log("No Data"):console.log("Readble Mode Data: ",Z.read())}),Z.on("data",function(r){console.log("Flowing Mode Data: ",r.toString()),He.webview.postMessage(r.toString())})}function Fr(){Z.close()}function es(){}0&&(module.exports={activate,deactivate});
